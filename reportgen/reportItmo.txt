1) PROJECT IDENTIFICATION 
1.1 - Name: ITMOLOD Project
1.2 - Homepage: http://lod.ifmo.ru
1.3 - Creator: Ivan Ermilov
1.4 - Goal: Offering university historical and actual data under LOD principles.
1.5 - Description: The ITMO project is a cooperation between ITMO University of Saint Petersburg and the University of Leipzig. It consists of conversion of ITMO University database data to RDF (SPARQL endpoint, Pubby), extension of the existing vivo Ontology to cover the data (Ontology), create applications from the RDF data, such as visualizations (Laboratory Heatmap) and a search.
The RDF data is publicly available at http://lod.ifmo.ru/sparql.


2) WORKFLOW

2.1 - workflow_ITMOLOD

2.1.1 - Short Description: Workflow applied to create linked dataset of actual data of ITMO university.

2.1.2 - Steps


2.1.2.1 - step_extracting_itmolod_from_legacy_system

Contributor: Ivan Ermilov

Stage: Extraction

Performed at: 2015-01-15

Input Datasets:

dataset_oracle_itmolod
 (File format: SQL Format)
 (Location: jdbc:oracle:thin://192.168.1.2:1521/oracis)
 (License: No license defined)

Output Dataset: 
dataset_itmo_rdf
 (File format: N-triples Format)
 (Location: /home/srautenberg/workspace/itmo/data/)
 (License: No license defined)

Tool: Sparqlify


Short Description: - For the reason of security, it is needed to have to run a connection script to the
  ITMOLOD git repository on github.com
- After establishing the connection with the network, the next step is to retrieve the
  data from RDBMS, convert it to the RDF and store it on the local file system. All 
  three steps are performed by the Sparqlify tool. Given that all necessary mappings
  are defined and are available in $ITMOLODGIT/mappings folder. 
- The used command to run this step is described in command. It uses the script
  described bellow.


Script: $ ./sparqlify-all.sh
#!/bin/bash

CURRENT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
ROOT_DIR=$(dirname $CURRENT_DIR)
rm $ROOT_DIR/mappings/all.sml
0mkdir $ROOT_DIR/data
for D in `find $ROOT_DIR/mappings -type d`
do
  for file in $D/*.sml; 
  do 
    filename=$(basename "$file")
    extension="${filename##*.}"
    filename="${filename%.*}"
    sparqlify -D -U username -W password -j jdbc:oracle:thin:ISU_SEMANTIC/username@192.168.1.2:1521/oracis -m $file | tee $ROOT_DIR/data/$filename.nt
  done 
done


Command: /home/srautenberg/workspace/itmo/bin/sparqlify-all.sh


2.1.2.2 - step_storing_itmolod

Contributor: Ivan Ermilov

Stage: Storage/Querying Stage

Performed at: 2015-01-15

Input Datasets:

dataset_itmo_rdf
 (File format: N-triples Format)
 (Location: /home/srautenberg/workspace/itmo/data/)
 (License: No license defined)

Tool: Virtuoso RDF Store


Short Description: - load all the RDF files to the TripleStore (in our case we use OpenLink Virtuoso
  Open Source Edition). 
- To run this step, execute the command line bellow.
- The command uses the script described bellow.


Script: #!/bin/bash

#transform the data
CURRENT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
while true; do
  read -p "Do you wish to transform all the data? (may take several minutes) [yn] " yn
    case $yn in
        [Yy]* ) $CURRENT_DIR/sparqlify-all.sh; break;;
        [Nn]* ) break;;
        * ) echo "Please answer yes or no.";;
    esac
done

DATA_DIR=$(dirname $(pwd))/data
DATA_FILE=$DATA_DIR/itmo.nt
mv $DATA_FILE $DATA_FILE.old
ERROR=0
for file in $DATA_DIR/*.nt; 
do
  FILESIZE=$(stat -c%s $file)
  if [ $FILESIZE -eq 0 ]; 
  then
    echo "$file is empty" >>  errors.txt
    $ERROR=1
  else
    grep "^<http" $file;
  fi;
done 2>/dev/null >> $DATA_DIR/itmo.nt
#load into virtuoso
if [ $ERROR -eq 0 ];
then
  echo "No empty files deleted. Loading to the server"
  virtload $DATA_FILE http://lod.ifmo.ru
else
  echo "Some of the files are not converted correctly (contains no data)"
fi;


Command: /home/srautenberg/workspace/itmo/bin/load-all.sh



